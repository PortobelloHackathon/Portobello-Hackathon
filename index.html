<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portobello Dashboard</title>

  <!-- Inter font -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter','ui-sans-serif','system-ui'] },
          colors: {
            pbBlue: '#0B1F52',       // brand dark blue
            pbSlate: '#6B7280',      // (kept in case you use it)
            pbGrayLight: '#CFD3DA',  // brand light gray
            pbGrayMid:   '#7C8390',  // brand mid gray
            pbGrayDark:  '#434A52'   // brand dark gray
          }
        }
      }
    }
  </script>
</head>

<body class="h-screen flex flex-col bg-slate-50 text-slate-800 font-sans">
  <!-- HEADER: gray (left) -> dark blue (right), title in brand blue -->
  <header class="bg-gradient-to-r from-pbGrayLight via-pbGrayMid/80 to-pbBlue">
    <div class="mx-auto max-w-7xl px-6 py-5">
      <div class="flex items-baseline gap-2">
  <img src="assets/images/logo_portobello_america_CORES_pantone_655.png" alt="Portobello America" class="h-16 object-contain" />
      </div>
    </div>
  </header>

  <div class="flex flex-1 overflow-hidden">
    <!-- SIDEBAR -->
    <aside class="w-48 bg-slate-50 border-r shadow-lg">
      <nav class="mt-6 flex flex-col" aria-label="Primary">
        <a href="index.html" onclick="location.href='index.html'" class="flex items-center px-5 py-3 bg-[#0b1f52] text-white font-semibold rounded-r-full mb-2 shadow-sm">
          <span>Analytics</span>
        </a>
        <a href="inventory.html" onclick="location.href='inventory.html'" class="flex items-center px-5 py-3 text-slate-700 hover:bg-slate-200 rounded-r-full mb-2 transition">
          <span>Inventory</span>
        </a>
      </nav>
    </aside>

    <!-- MAIN -->
    <main class="flex-1 overflow-auto">
      <div class="mx-auto max-w-7xl px-8 py-8">
        <h2 class="text-3xl font-semibold tracking-tight text-slate-900">Analytics</h2>

        <!-- DASHBOARD GRID -->
        <div class="mt-6 grid grid-cols-12 gap-4">
          <!-- Left: Line chart -->
          <section class="col-span-12 lg:col-span-8 rounded-2xl border border-slate-200 bg-white shadow-sm p-4 h-[22rem]">
            <div class="flex items-center justify-between mb-2">
              <h3 class="text-lg font-semibold text-slate-800">Material Loss â€” Last 24h</h3>
              <span class="text-sm text-slate-500">kg</span>
            </div>
            <canvas id="lossLineChart" class="w-full h-full"></canvas>
          </section>

          <!-- Right: KPI donuts (smaller, fixed-size) -->
<section class="col-span-12 lg:col-span-4 grid grid-cols-1 gap-3">
  <div class="rounded-2xl border border-slate-200 bg-white shadow-sm p-3">
    <h3 class="text-sm font-medium text-slate-600 mb-1">Yield</h3>
    <div class="flex items-center gap-3">
      <!-- fixed-size wrapper -->
      <div class="shrink-0 w-16 h-16">
        <canvas id="kpiDonut1" class="!w-full !h-full"></canvas>
      </div>
      <div class="text-slate-600 text-xs">Good parts / total</div>
    </div>
  </div>

  <div class="rounded-2xl border border-slate-200 bg-white shadow-sm p-3">
    <h3 class="text-sm font-medium text-slate-600 mb-1">Scrap Rate</h3>
    <div class="flex items-center gap-3">
      <div class="shrink-0 w-16 h-16">
        <canvas id="kpiDonut2" class="!w-full !h-full"></canvas>
      </div>
      <div class="text-slate-600 text-xs">Scrap / input</div>
    </div>
  </div>

  <div class="rounded-2xl border border-slate-200 bg-white shadow-sm p-3">
    <h3 class="text-sm font-medium text-slate-600 mb-1">On-Time</h3>
    <div class="flex items-center gap-3">
      <div class="shrink-0 w-16 h-16">
        <canvas id="kpiDonut3" class="!w-full !h-full"></canvas>
      </div>
      <div class="text-slate-600 text-xs">Orders on schedule</div>
    </div>
  </div>
</section>

          <!-- Multi-ring donut -->
          <section class="col-span-12 rounded-2xl border border-slate-200 bg-white shadow-sm p-4 h-[18rem]">
            <h3 class="text-lg font-semibold text-slate-800 mb-2">Loss Breakdown by Step</h3>
            <canvas id="multiRingDonut" class="w-full h-full"></canvas>
          </section>
        </div>
      </div>
    </main>
  </div>

  <!-- Chart.js (single include) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <script>
    // ---- Brand colors ----
    const PB_BLUE   = '#0B1F52';
    const PB_GRAY_D = '#434A52';
    const PB_GRAY_M = '#7C8390';
    const PB_GRAY_L = '#CFD3DA';

    // ---- Chart.js defaults ----
    Chart.defaults.font.family = 'Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif';
    Chart.defaults.color = PB_GRAY_D;
    Chart.defaults.plugins.legend.display = false;

    // Canvases
    const lineCtx = document.getElementById('lossLineChart');
    const kpi1Ctx = document.getElementById('kpiDonut1');
    const kpi2Ctx = document.getElementById('kpiDonut2');
    const kpi3Ctx = document.getElementById('kpiDonut3');
    const multiCtx = document.getElementById('multiRingDonut');

    // Line chart
    const lossLineChart = new Chart(lineCtx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [{
          label: 'Loss (kg)',
          data: [],
          borderColor: PB_BLUE,
          backgroundColor: PB_BLUE + '22',
          pointBackgroundColor: PB_BLUE,
          pointRadius: 4,
          pointHoverRadius: 6,
          tension: 0.3,
          fill: true
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: { grid: { display: false } },
          y: { grid: { color: PB_GRAY_L } }
        }
      }
    });

    // Donut helper
    function makeDonut(ctx, pct, color = PB_BLUE) {
      return new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['Complete','Remaining'],
          datasets: [{
            data: [pct, 100 - pct],
            backgroundColor: [color, PB_GRAY_L],
            borderWidth: 0,
            cutout: '70%'
          }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,   // <-- key for small fixed boxes
            plugins: {
                legend: { display: false },
                tooltip: { enabled: false }
            },
        }
      });
    }

    const kpiYield  = makeDonut(kpi1Ctx, 0);
    const kpiScrap  = makeDonut(kpi2Ctx, 0, PB_GRAY_M);
    const kpiOnTime = makeDonut(kpi3Ctx, 0);

    // Multi-ring donut example
    const multi = new Chart(multiCtx, {
      type: 'doughnut',
      data: {
        labels: ['Cutting','Assembly','QC','Packaging'],
        datasets: [
          { data: [90,10,0,0], backgroundColor: [PB_BLUE, PB_GRAY_L, PB_GRAY_L, PB_GRAY_L], borderWidth: 0, cutout: '60%' },
          { data: [0,80,20,0], backgroundColor: [PB_GRAY_L, PB_BLUE, PB_GRAY_L, PB_GRAY_L], borderWidth: 0, cutout: '75%' },
          { data: [0,0,70,30], backgroundColor: [PB_GRAY_L, PB_GRAY_L, PB_BLUE, PB_GRAY_M], borderWidth: 0, cutout: '85%' }
        ]
      },
      options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: true } } }
    });

    // Single entry point to update charts
    function updateDashboard(data) {
      lossLineChart.data.labels = data.times || [];
      lossLineChart.data.datasets[0].data = data.lossKg || [];
      lossLineChart.update();

      kpiYield.data.datasets[0].data = [data.kpis.yieldPct, 100 - data.kpis.yieldPct]; kpiYield.update();
      kpiScrap.data.datasets[0].data = [data.kpis.scrapPct, 100 - data.kpis.scrapPct]; kpiScrap.update();
      kpiOnTime.data.datasets[0].data = [data.kpis.onTimePct, 100 - data.kpis.onTimePct]; kpiOnTime.update();
    }

    // Demo data
    updateDashboard({
      times:  ['08:00','09:00','10:00','11:00','12:00','13:00','14:00','15:00'],
      lossKg: [12, 9, 11, 15, 13, 18, 16, 14],
      kpis:   { yieldPct: 86, scrapPct: 14, onTimePct: 92 }
    });

    // Later: updateDashboard(realData)
  </script>
</body>
</html>